From b61ad1a372d533219e4521d1a01faf5b5cb3b3b2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Martin=20Povi=C5=A1er?= <povik+lin@cutebit.org>
Date: Sat, 19 Feb 2022 18:28:17 +0100
Subject: [PATCH] ASoC: apple-mca: Fix off-by-one error
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

An all time classic.

Signed-off-by: Martin Povi≈°er <povik+lin@cutebit.org>
---
 sound/soc/apple/mca.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/sound/soc/apple/mca.c b/sound/soc/apple/mca.c
index 6e38d1637780..20599bf0577f 100644
--- a/sound/soc/apple/mca.c
+++ b/sound/soc/apple/mca.c
@@ -120,7 +120,7 @@ struct mca_route {
 
 	struct clk *clk_parent;
 
-	bool clocks_in_use[SNDRV_PCM_STREAM_LAST];
+	bool clocks_in_use[SNDRV_PCM_STREAM_LAST + 1];
 
 	unsigned int tdm_slots;
 	unsigned int tdm_slot_width;
-- 
2.32.0 (Apple Git-132)

From b781e0ccdc0c9a931571d15db09d45b7258b9905 Mon Sep 17 00:00:00 2001
From: Jens Axboe <axboe@kernel.dk>
Date: Sat, 19 Feb 2022 08:35:01 -0700
Subject: [PATCH] apple-mca: correct prinkts

Signed-off-by: Jens Axboe <axboe@kernel.dk>
---
 sound/soc/apple/mca.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/sound/soc/apple/mca.c b/sound/soc/apple/mca.c
index 6e38d1637780..442434ca3a88 100644
--- a/sound/soc/apple/mca.c
+++ b/sound/soc/apple/mca.c
@@ -914,7 +914,7 @@ static int apple_mca_probe(struct platform_device *pdev)
 		mca->clk_parents[i] = clk;
 
 		if (IS_ERR(clk)) {
-			dev_err(&pdev->dev, "unable to obtain clock %s: %d\n",
+			dev_err(&pdev->dev, "unable to obtain clock %s: %ld\n",
 				name, PTR_ERR(clk));
 			ret = PTR_ERR(clk);
 			goto err_release_chans_clocks;
@@ -948,8 +948,8 @@ static int apple_mca_probe(struct platform_device *pdev)
 			chan = of_dma_request_slave_channel(pdev->dev.of_node, name);
 			if (IS_ERR(chan)) {
 				if (PTR_ERR(chan) != -EPROBE_DEFER)
-					dev_err(&pdev->dev, "no %s DMA channel: %d\n",
-						name, route->of_node, PTR_ERR(chan));
+					dev_err(&pdev->dev, "no %s DMA channel: %ld\n",
+						name, PTR_ERR(chan));
 
 				ret = PTR_ERR(chan);
 				goto err_release_chans_clocks;
-- 
2.30.2

